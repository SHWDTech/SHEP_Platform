@{
    ViewBag.Title = "PutianExport";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="panel panel-default">
    <div class="panel-heading">
        <h4>历史统计数据导出</h4>
    </div>
    <div class="panel-body">
        <div class="form-group">
            <label class="label120">选择时间范围：</label>
            <div>
                @{
                    var time = DateTime.Now;
                }
                <div id="date-selecter" class="input-group">
                    <div class='input-group date' id='startDate'>
                        <input type='text' class="form-control" name="startDate" style="width: 150px;" value="@time.ToString("yyyy-MM-dd")" />
                        <span class="glyphicon glyphicon-calendar input-group-addon"></span>
                    </div>
                    <span style="margin-top: auto; margin-bottom: auto;"> - </span>
                    <div class='input-group date' id='endDate'>
                        <input type='text' class="form-control" name="endDate" style="width: 150px;" value="@time.AddDays(1).ToString("yyyy-MM-dd")" />
                        <span class="glyphicon glyphicon-calendar input-group-addon"></span>
                    </div>
                </div>
            </div>
            <label class="label120">数据类型：</label>
            <select class="form-control daterange" id="datatype" name="datatype" style="width: 120px; min-width: 120px;">
                <option value="0">小时均值</option>
                <option value="1">日均值</option>
            </select>
            <input id="confirmExport" type="button" value="确认" class="btn btn-primary" />
            <a id="putianExport" class="btn btn-success" style="margin-left: 10px;" download>导出</a>
        </div>
    </div>
</div>
@section css{
    @Styles.Render("~/Content/datetimepickercss")
    @Styles.Render("~/Content/select2-bootstrap")
    <link href="/Content/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" />
    <style type="text/css">
        .form-group {
            display: flex;
        }

        .form-horizontal .form-group {
            margin-left: 0;
        }

        label {
            margin-top: auto;
            margin-bottom: auto;
        }

        #date-selecter {
            display: flex;
        }
    </style>
}

@section scripts{
    @Scripts.Render("~/bundles/datetimepicker")
    @Scripts.Render("~/bundles/select2")
    <script type="text/javascript" src="/Scripts/Utility/jquery.unobtrusive-ajax.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $('#startDate').datetimepicker({
                locale: 'zh-cn',
                format: 'YYYY-MM-DD'
            });

            $('#endDate').datetimepicker({
                locale: 'zh-cn',
                format: 'YYYY-MM-DD'
            });

            $('#confirmExport').on('click', function() {
                $('#putianExport').attr('href', '/Export/ExportReport?DataType='
                    + $('#datatype').val()
                    + '&StartDateTime=' + $('#startDate').find('input').val()
                    + '&EndDateTime=' + $('#endDate').find('input').val());
            });
        });
    </script>
}