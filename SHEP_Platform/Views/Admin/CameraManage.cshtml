@model SHEP_Platform.Models.Admin.CameraManageViewModel
@{
    ViewBag.Title = "摄像头管理";
}

<link rel="stylesheet" type="text/css" href="~/Content/bootstrap-table.css">
<div class="control-layer horizontal-group" style="display:flex;height:34px;line-height:34px;padding:1px;" ">
    <span class="span60">所属设备:</span>
    <select class="form-control" id="" style="width:120px;">
        <option value="0">全部</option>
    </select>
    <span class="span60">序列号:</span>
    <select class="form-control" id="" style="width:120px;">
        <option value="0">全部</option>
    </select>
    <input type="button" value="查询" id="" />
</div>
<div>
    @{
        var table = Html.BootstrapTable(null, TablePaginationOption.server, new
        {
            id = "cammgrTable",
            data_page_size = 25,
            data_reset_offset = true,
            data_url = "/Admin/CamsTable",
            data_height = 600
        });
        var builder = table.Column("摄像头名称", "CameraName")
            .Column("所属设备", "DevCode")
            .Column("序列号", "UserName")
            .Column("操作")
            .Apply(ColumnOption.width, "180")
            .Apply(ColumnOption.formatter, "camMgrFormatter")
            .Apply(ColumnOption.events, "camMgrEvents");
    }
    @(builder)
</div>

@section scripts{
    @Scripts.Render("~/bundles/bootstrap-table")
    <script type="text/javascript">
        window.camMgrFormatter = function (index, row, element) {
            return [
                '<a class="update" href="/Admin/Camera/' + row.ID + '" style="margin-right: 5px;"><span class="glyphicon glyphicon-edit">更新</span></a>',
                '<a class="delete" href="javascript:void(0)" style="margin-right: 5px;"><span class="glyphicon glyphicon-remove">删除</span></a>',
                '<a class="view" href="/Monitor/StatViewHikSecond?id=' + row.UserName + '" ><span class="glyphicon glyphicon-camera">查看</span></a>'
            ].join('');
        }

        window.camMgrEvents = {
            'click .delete': function (e, value, row) {
                if (confirm('确定删除该摄像头吗？')) {
                    $.get('/Admin/CameraDelete/' + row.ID, null, function (ret) {
                        if (ret.msg === 'success') {
                            $('#' + id).remove();
                            msg.info('删除成功');
                        }
                    });
                }
            }
        };

        $(function () {
            $('#cammgrTable').bootstrapTable();
        });
    </script>
}
